# –û—Ç—á—ë—Ç –ø–æ –¥–æ–º–∞—à–Ω–µ–º—É –∑–∞–¥–∞–Ω–∏—é ¬´Conditional GAN¬ª

**–°—Å—ã–ª–∫–∞ –Ω–∞ –Ω–æ—É—Ç–±—É–∫ —Å –ø–æ–ª–Ω—ã–º –∫–æ–¥–æ–º –∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–º–∏:**  
https://www.kaggle.com/–≤–∞—à_–ª–æ–≥–∏–Ω/conditional-gan-homework

---

## 1. –ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏

–í —ç—Ç–æ–º –¥–æ–º–∞—à–Ω–µ–º –∑–∞–¥–∞–Ω–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ:

1. **–û–±—É—á–∏—Ç—å Conditional GAN** –Ω–∞ –ª—é–±–æ–º CV-–¥–∞—Ç–∞—Å–µ—Ç–µ ‚Äî —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–æ –æ–¥–Ω–æ–º—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é –Ω–∞ –∫–∞–∂–¥—ã–π –∫–ª–∞—Å—Å.  
2. **–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –≤–ª–∏—è–Ω–∏–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏** Conv2d/ConvTranspose2d: –∫–∞–∫ –º–∏–Ω–∏–º—É–º –¥–≤–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è.  
3. **–û—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã** –ø—Ä–æ CGAN vs GAN, –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è –∏ —Ä–æ–ª—å –ª–∞—Ç–µ–Ω—Ç–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞.

---

## 2. –î–∞–Ω–Ω—ã–µ –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è

- **–î–∞—Ç–∞—Å–µ—Ç:** CIFAR-10 (10 –∫–ª–∞—Å—Å–æ–≤, 32√ó32).  
- **–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏:**  
  - –ø—Ä–∏–≤–µ–¥–µ–Ω–æ –∫ grayscale (1 –∫–∞–Ω–∞–ª) —á–µ—Ä–µ–∑ `transforms.Grayscale(1)`;  
  - `Resize(32)`, `ToTensor()`, `Normalize([0.5], [0.5])` ‚Üí –ø–∏–∫—Å–µ–ª–∏ –≤ \[-1, +1\].  
- **–ü—Ä–∏—á–∏–Ω–∞:** —É–ø—Ä–æ—â–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—É ‚Äî –º–µ–Ω—å—à–µ —Ü–≤–µ—Ç–æ–≤—ã—Ö –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤, –±–æ–ª–µ–µ —á—ë—Ç–∫–∏–µ –¥–µ—Ç–∞–ª–∏.

---

## 3. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ —É–ª—É—á—à–µ–Ω–∏—è

- **Generator**:  
  - –≤—Ö–æ–¥: —à—É–º \(z\in\mathbb{R}^{100}\) + —ç–º–±–µ–¥–¥–∏–Ω–≥ –º–µ—Ç–∫–∏ \(\in\mathbb{R}^{100}\) ‚Üí –ª–∏–Ω–µ–π–Ω—ã–π —Å–ª–æ–π ‚Üí —Ä–∞–∑–≤—ë—Ä—Ç–∫–∞ ‚Üí –Ω–µ—Å–∫–æ–ª—å–∫–æ –±–ª–æ–∫–æ–≤ ConvTranspose2d ‚Üí –≤—ã—Ö–æ–¥ 1√ó32√ó32 + Tanh.  
- **Discriminator**:  
  - –Ω–∞ –≤—Ö–æ–¥ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∏—Ä—É–µ—Ç—Å—è grayscale-–∫–∞—Ä—Ç–∏–Ω–∫–∞ (1 –∫–∞–Ω–∞–ª) –∏ ¬´–∫–∞—Ä—Ç–∞ –º–µ—Ç–æ–∫¬ª (num_classes –∫–∞–Ω–∞–ª–æ–≤), –∑–∞—Ç–µ–º –æ–±—ã—á–Ω—ã–µ Conv2d‚ÜíLeakyReLU‚ÜíBatchNorm‚ÜíFC‚ÜíSigmoid.  
- **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:** normal (ùí©(0,0.02)), Xavier, Kaiming.  
- **–£–ª—É—á—à–µ–Ω–∏—è:**  
  - –ø–µ—Ä–µ–≤—ë–ª –º–æ–¥–µ–ª—å –Ω–∞ 1-–∫–∞–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º (—Å–Ω–∏–∂–µ–Ω–∏–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏),  
  - —É–≤–µ–ª–∏—á–∏–ª —á–∏—Å–ª–æ —ç–ø–æ—Ö —Å 10 –¥–æ 25 –¥–ª—è –±–æ–ª–µ–µ –ø–æ–ª–Ω–æ–π —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏,  
  - –¥–æ–±–∞–≤–∏–ª `tqdm` –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞,  
  - —Å–æ—Ö—Ä–∞–Ω–∏–ª –≤–µ—Å–∞ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏.

---

## 4. –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç: —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–π

–í—ã–ø–æ–ª–Ω–µ–Ω—ã —Ç—Ä–∏ –ø—Ä–æ–≥–æ–Ω–∞ `train_cgan(init_mode)` —Å `init_mode` = `normal`, `xavier`, `kaiming`.  
–ö–∞–∂–¥—ã–π –ø—Ä–æ–≥–æ–Ω ‚Äî 25 —ç–ø–æ—Ö; –≤ –∫–æ–Ω—Ü–µ ‚Äî —Å—Ä–µ–¥–Ω–∏–µ –ª–æ—Å—Å—ã –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ –∏ –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ç–æ—Ä–∞ –ø–æ —ç–ø–æ—Ö–∞–º.

### 4.1. –ì—Ä–∞—Ñ–∏–∫–∏ –ø–æ—Ç–µ—Ä—å

![Generator vs Discriminator Loss Comparison][loss_plot]

> **–†–∏—Å.1**. –°–ª–µ–≤–∞ ‚Äî `Generator Loss` –ø–æ —ç–ø–æ—Ö–∞–º –¥–ª—è —Ç—Ä—ë—Ö –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–π.  
> –°–ø—Ä–∞–≤–∞ ‚Äî `Discriminator Loss` –¥–ª—è —Ç–µ—Ö –∂–µ —Ä–µ–∂–∏–º–æ–≤.

---

## 5. –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

1. **Normal init**  
   - **G loss**: –Ω–∞ –ø–µ—Ä–≤—ã—Ö —ç–ø–æ—Ö–∞—Ö –º–µ–¥–ª–µ–Ω–Ω—ã–π —Å–ø–∞–¥, –ø–æ—Å–ª–µ ~20-–π ‚Äî —Ä–µ–∑–∫–∏–π —Ä–æ—Å—Ç –¥–æ ~2.0 ‚Üí –ø—Ä–∏–∑–Ω–∞–∫ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏.  
   - **D loss**: –ø–æ—á—Ç–∏ —Å—Ä–∞–∑—É —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –Ω–∞ ~0.70, –Ω–æ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä ¬´—É–±–µ–≥–∞–µ—Ç¬ª –æ—Ç –Ω–µ–≥–æ.

2. **Xavier init**  
   - **G loss**: —Ä–æ–≤–Ω–∞—è, –º–µ–¥–ª–µ–Ω–Ω–∞—è —Å—Ö–æ–¥–∏–º–æ—Å—Ç—å –∫ ~0.70 –∑–∞ 25 —ç–ø–æ—Ö.  
   - **D loss**: –±—ã—Å—Ç—Ä–æ —Å–ø–∞–¥–∞–µ—Ç –∫ ~0.70 –∏ –¥–µ—Ä–∂–∏—Ç—Å—è —Ç–∞–º –≤—Å—é —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É.  
   - **–í—ã–≤–æ–¥:** —Å–∞–º–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –∏ –±—ã—Å—Ç—Ä–∞—è —Å—Ö–æ–¥–∏–º–æ—Å—Ç—å –±–µ–∑ —Ä–µ–∑–∫–∏—Ö —Å–∫–∞—á–∫–æ–≤.

3. **Kaiming init**  
   - **G loss**: —Å–∏–ª—å–Ω—ã–π –ø–∏–∫ –Ω–∞ 2‚Äì3 —ç–ø–æ—Ö–µ (~1.45), –∑–∞—Ç–µ–º –º–µ–¥–ª–µ–Ω–Ω—ã–π —Ä–æ—Å—Ç –¥–æ ~1.20.  
   - **D loss**: –±–æ–ª—å—à–∏–µ –∫–æ–ª–µ–±–∞–Ω–∏—è (0.51‚Üí0.65‚Üí0.55) ‚Üí –º–µ–Ω–µ–µ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–µ –æ–±—É—á–µ–Ω–∏–µ.

**–ò—Ç–æ–≥:**  
–ª—É—á—à–µ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π –ø—Ä–∏–∑–Ω–∞–Ω–∞ **Xavier**: –æ–Ω–∞ –¥–∞—ë—Ç –ø–ª–∞–≤–Ω—É—é —Å—Ö–æ–¥–∏–º–æ—Å—Ç—å –æ–±–µ–∏—Ö —Å–µ—Ç–µ–π –±–µ–∑ mode-collapse –∏ –≤–∑—Ä—ã–≤–æ–≤ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞.

---

## 6. –û—Ç–≤–µ—Ç—ã –Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã

1. **CGAN vs GAN**  
   - **GAN**: $\(G(z)\), \(D(x)\)$ –±–µ–∑ –º–µ—Ç–æ–∫.  
   - **CGAN**: $\(G(z,y)\), \(D(x,y)\)$: –º–µ—Ç–∫–∞ y –ø–æ–¥–º–µ—à–∏–≤–∞–µ—Ç—Å—è –∫–∞–∫ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –≤—Ö–æ–¥ (concat/embed+expand).

2. **–ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è GAN**  
   - –ø—Ä–æ–±–ª–µ–º—ã: –∞—Å–∏–º–º–µ—Ç—Ä–∏—è —Å–∫–æ—Ä–æ—Å—Ç–µ–π G/D, –∏—Å—á–µ–∑–∞—é—â–∏–π/–≤–∑—Ä—ã–≤–∞—é—â–∏–π—Å—è –≥—Ä–∞–¥–∏–µ–Ω—Ç, mode collapse.  
   - —Ç–µ—Ö–Ω–∏–∫–∏ —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏: –ø–æ–¥–±–æ—Ä lr/Œ≤ –¥–ª—è Adam, label smoothing, gradient penalty (WGAN-GP), spectral normalization, instance noise.

3. **–†–æ–ª—å –ª–∞—Ç–µ–Ω—Ç–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –≤ CGAN**  
   - $\(z\sim\mathcal{N}(0,I)\)$ –∫–æ–¥–∏—Ä—É–µ—Ç –≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã.  
   - –≤ CGAN —É—Å–ª–æ–≤–∏–µ $\(y\)$ ¬´—Ä–∞–∑–±–∏–≤–∞–µ—Ç¬ª –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –Ω–∞ –ø–æ–¥—Ç–æ–ø–æ–ª–æ–≥–∏–∏, –ø–æ–∑–≤–æ–ª—è—è –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—É —Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ –∫–ª–∞—Å—Å-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –≤–∞—Ä–∏–∞—Ü–∏—è—Ö.

---

## 7. –í—ã–≤–æ–¥—ã

- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏ —Å–∫–æ—Ä–æ—Å—Ç—å —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏ CGAN.  
- –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ grayscale –∏ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ —á–∏—Å–ª–∞ —ç–ø–æ—Ö (–¥–æ 25) —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ —É–ø—Ä–æ—Å—Ç–∏–ª–∏ –∑–∞–¥–∞—á—É –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—É –∏ —É–ª—É—á—à–∏–ª–∏ –∫–∞—á–µ—Å—Ç–≤–æ.  
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Xavier-–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é, spectral norm –∏ WGAN-GP –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ —É–ª—É—á—à–µ–Ω–∏—è.

---
